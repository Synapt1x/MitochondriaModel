<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>The Output Function and the Metal Data Structure</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html,frames,3 --> 
<meta name="src" content="QubistHTML.tex"> 
<meta name="date" content="2012-02-01 01:22:00"> 
<link rel="stylesheet" type="text/css" href="QubistHTML.css"> 
</head><body 
>
<!--l. 6162--><div class="crosslinks"><p class="noindent">[<a 
href="QubistHTMLse79.html" >next</a>] [<a 
href="QubistHTMLse77.html" >prev</a>] [<a 
href="QubistHTMLse77.html#tailQubistHTMLse77.html" >prev-tail</a>] [<a 
href="#tailQubistHTMLse78.html">tail</a>] [<a 
href="QubistHTMLch10.html#QubistHTMLse78.html" >up</a>] </p></div>
<h3 class="sectionHead"><span class="titlemark">10.5   </span> <a 
 id="x108-16400010.5"></a>The Output Function and the Metal Data Structure</h3>
<a 
 id="dx108-164001"></a>
<a 
 id="dx108-164002"></a>
<!--l. 6167--><p class="noindent" >Anvil supports an optional output function, which works just like the output functions used by Ferret and SAMOSA
(see Sections <a 
href="QubistHTMLse19.html#x34-510004.9">4.9<!--tex4ht:ref: sec:output --></a> and <a 
href="QubistHTMLse69.html#x98-1420009.6">9.6<!--tex4ht:ref: sec:SAMOSA_output --></a>). Anvil&#8217;s output function receives Anvil&#8217;s top-level internal data structure, called <span 
class="cmmi-10">metal</span>,
which is analogous to Ferret&#8217;s <span 
class="cmmi-10">world </span>and SAMOSA&#8217;s <span 
class="cmmi-10">simplex </span>structures. The signature of the Anvil output function
is as follows:
<!--l. 6172--><p class="noindent" ><span 
class="colorbox" id="colorbox111"> <div class="minipage"><div class="BVerbatimInput"><span 
class="cmtt-10">function</span><span 
class="cmtt-10">&#x00A0;output(metal)</span></div>
</div></span>
<!--l. 6178--><p class="noindent" >Anvil&#8217;s output function is called once per timestep, where a timestep is defined such that all Anvil tracks accept or
reject a perturbation by equation <a 
href="QubistHTMLse5.html#x15-24009r3">2.3<!--tex4ht:ref: eq:SA --></a>. Anvil&#8217;s output function has no return arguments. However, it can be used to
implement a custom stopping criterion, as discussed in Section <a 
href="QubistHTMLse19.html#x34-530004.9.2">4.9.2<!--tex4ht:ref: sec:customStopping --></a>.
<a 
 id="dx108-164004"></a>
<a 
 id="dx108-164005"></a>
<!--l. 6185--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">10.5.1   </span> <a 
 id="x108-16500010.5.1"></a>The Metal Data Structure</h4>
<a 
 id="dx108-165001"></a>
<a 
 id="dx108-165002"></a>
<!--l. 6190--><p class="noindent" >The <span 
class="cmmi-10">metal </span>data structure is organized as follows:
<!--l. 6228--><p class="noindent" ><span 
class="colorbox" id="colorbox112"> <div class="minipage"><div class="BVerbatimInput"><span 
class="cmtt-10">metal</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;.X</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;Matrix</span><span 
class="cmtt-10">&#x00A0;of</span><span 
class="cmtt-10">&#x00A0;parameter</span><span 
class="cmtt-10">&#x00A0;values.</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;Each</span><span 
class="cmtt-10">&#x00A0;column</span><span 
class="cmtt-10">&#x00A0;represents</span><span 
class="cmtt-10">&#x00A0;the</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;current</span><span 
class="cmtt-10">&#x00A0;parameters</span><span 
class="cmtt-10">&#x00A0;for</span><span 
class="cmtt-10">&#x00A0;a</span><span 
class="cmtt-10">&#x00A0;simulated</span><span 
class="cmtt-10">&#x00A0;annealing</span><span 
class="cmtt-10">&#x00A0;track.</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;.F</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;Matrix</span><span 
class="cmtt-10">&#x00A0;of</span><span 
class="cmtt-10">&#x00A0;fitness</span><span 
class="cmtt-10">&#x00A0;values.</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;Each</span><span 
class="cmtt-10">&#x00A0;column</span><span 
class="cmtt-10">&#x00A0;represents</span><span 
class="cmtt-10">&#x00A0;the</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;current</span><span 
class="cmtt-10">&#x00A0;parameters</span><span 
class="cmtt-10">&#x00A0;for</span><span 
class="cmtt-10">&#x00A0;a</span><span 
class="cmtt-10">&#x00A0;simulated</span><span 
class="cmtt-10">&#x00A0;annealing</span><span 
class="cmtt-10">&#x00A0;track.</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;.XCPD</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;Matrix</span><span 
class="cmtt-10">&#x00A0;of</span><span 
class="cmtt-10">&#x00A0;parameter</span><span 
class="cmtt-10">&#x00A0;values,</span><span 
class="cmtt-10">&#x00A0;including</span><span 
class="cmtt-10">&#x00A0;CPD</span><span 
class="cmtt-10">&#x00A0;information.</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;&#8216;NaN&#8217;</span><span 
class="cmtt-10">&#x00A0;indicates</span><span 
class="cmtt-10">&#x00A0;an</span><span 
class="cmtt-10">&#x00A0;unspecified</span><span 
class="cmtt-10">&#x00A0;parameter.</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;.auxOutput</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;Auxiliary</span><span 
class="cmtt-10">&#x00A0;output.</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;See</span><span 
class="cmtt-10">&#x00A0;fitness</span><span 
class="cmtt-10">&#x00A0;function</span><span 
class="cmtt-10">&#x00A0;syntax.</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;auxOutput</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;is</span><span 
class="cmtt-10">&#x00A0;empty</span><span 
class="cmtt-10">&#x00A0;{}</span><span 
class="cmtt-10">&#x00A0;when</span><span 
class="cmtt-10">&#x00A0;not</span><span 
class="cmtt-10">&#x00A0;used.</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;When</span><span 
class="cmtt-10">&#x00A0;used,</span><span 
class="cmtt-10">&#x00A0;each</span><span 
class="cmtt-10">&#x00A0;cell</span><span 
class="cmtt-10">&#x00A0;index</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;corresponds</span><span 
class="cmtt-10">&#x00A0;to</span><span 
class="cmtt-10">&#x00A0;its</span><span 
class="cmtt-10">&#x00A0;respective</span><span 
class="cmtt-10">&#x00A0;columns</span><span 
class="cmtt-10">&#x00A0;in</span><span 
class="cmtt-10">&#x00A0;the</span><span 
class="cmtt-10">&#x00A0;X</span><span 
class="cmtt-10">&#x00A0;and</span><span 
class="cmtt-10">&#x00A0;F</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;matrices.</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;.T</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;Temperature</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;.metric</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;Distance</span><span 
class="cmtt-10">&#x00A0;information</span><span 
class="cmtt-10">&#x00A0;used</span><span 
class="cmtt-10">&#x00A0;internally</span><span 
class="cmtt-10">&#x00A0;for</span><span 
class="cmtt-10">&#x00A0;a</span><span 
class="cmtt-10">&#x00A0;niching</span><span 
class="cmtt-10">&#x00A0;operator.</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;Probably</span><span 
class="cmtt-10">&#x00A0;not</span><span 
class="cmtt-10">&#x00A0;useful</span><span 
class="cmtt-10">&#x00A0;to</span><span 
class="cmtt-10">&#x00A0;users.</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;.OptimalSolutions</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;Structure</span><span 
class="cmtt-10">&#x00A0;containing</span><span 
class="cmtt-10">&#x00A0;all</span><span 
class="cmtt-10">&#x00A0;known</span><span 
class="cmtt-10">&#x00A0;optimal</span><span 
class="cmtt-10">&#x00A0;solutions</span><span 
class="cmtt-10">&#x00A0;at</span><span 
class="cmtt-10">&#x00A0;the</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;present</span><span 
class="cmtt-10">&#x00A0;timestep.</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;.graphics</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;Graphics</span><span 
class="cmtt-10">&#x00A0;information</span><span 
class="cmtt-10">&#x00A0;used</span><span 
class="cmtt-10">&#x00A0;internally</span><span 
class="cmtt-10">&#x00A0;for</span><span 
class="cmtt-10">&#x00A0;Anvil</span><span 
class="cmtt-10">&#x00A0;plots.</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;.T</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;Temperature</span><span 
class="cmtt-10">&#x00A0;history,</span><span 
class="cmtt-10">&#x00A0;as</span><span 
class="cmtt-10">&#x00A0;displayed</span><span 
class="cmtt-10">&#x00A0;in</span><span 
class="cmtt-10">&#x00A0;the</span><span 
class="cmtt-10">&#x00A0;Anvil</span><span 
class="cmtt-10">&#x00A0;window.</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;.F</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;Best</span><span 
class="cmtt-10">&#x00A0;(minimum)</span><span 
class="cmtt-10">&#x00A0;fitness</span><span 
class="cmtt-10">&#x00A0;for</span><span 
class="cmtt-10">&#x00A0;each</span><span 
class="cmtt-10">&#x00A0;objective,</span><span 
class="cmtt-10">&#x00A0;as</span><span 
class="cmtt-10">&#x00A0;a</span><span 
class="cmtt-10">&#x00A0;function</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;of</span><span 
class="cmtt-10">&#x00A0;timestep.</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;.par</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;par</span><span 
class="cmtt-10">&#x00A0;structure,</span><span 
class="cmtt-10">&#x00A0;as</span><span 
class="cmtt-10">&#x00A0;loaded</span><span 
class="cmtt-10">&#x00A0;from</span><span 
class="cmtt-10">&#x00A0;the</span><span 
class="cmtt-10">&#x00A0;setup</span><span 
class="cmtt-10">&#x00A0;file.</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;|</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;.user.extPar</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;External</span><span 
class="cmtt-10">&#x00A0;parameters</span><span 
class="cmtt-10">&#x00A0;from</span><span 
class="cmtt-10">&#x00A0;the</span><span 
class="cmtt-10">&#x00A0;user&#8217;s</span><span 
class="cmtt-10">&#x00A0;init</span><span 
class="cmtt-10">&#x00A0;file.</span><br /></div>
</div></span>
<a 
 id="dx108-165038"></a>
<a 
 id="dx108-165039"></a>
<a 
 id="dx108-165040"></a>
<!--l. 6237--><p class="noindent" >The <span 
class="cmmi-10">X</span>, <span 
class="cmmi-10">F</span>, <span 
class="cmmi-10">XCPD</span>, and <span 
class="cmmi-10">auxOutput </span>fields are exactly like their counterparts in Ferret and require little
further explanation. Note that Ferret&#8217;s <span 
class="cmmi-10">XPhys </span>field is absent because Anvil doesn&#8217;t doesn&#8217;t normalize
parameter values internally; <span 
class="cmtt-10">metal.X </span>contains the &#8216;physical&#8217; parameters that would correspond to
<span 
class="cmtt-10">world.pop</span><span 
class="cmsy-10">{</span><span 
class="cmmi-10">p</span><span 
class="cmsy-10">}</span><span 
class="cmtt-10">.indiv.genome.XPhys </span>for population <span 
class="cmmi-10">p </span>in Ferret. The <span 
class="cmtt-10">metal.X </span>and <span 
class="cmtt-10">metal.XCPD </span>fields
are the same, except that <span 
class="cmmi-10">XCPD </span>may include <span 
class="cmmi-10">NaN </span>values as placeholders to indicate parameters
that are not specified. If a parameter contains mostly <span 
class="cmmi-10">NaN </span>values in the <span 
class="cmmi-10">metal </span>structure or the final
<span 
class="cmmi-10">OptimalSolutions </span>structure, then this means that the solutions are about equally fit, on average,
when these parameters are replaced by random numbers within the parameter range. If you wish to
                                                                                         

                                                                                         
examine parameters in your output function, then you almost certainly want to look at <span 
class="cmmi-10">X</span>, and not
<span 
class="cmmi-10">XCPD</span>.
<a 
 id="dx108-165041"></a>
<a 
 id="dx108-165042"></a>
<!--l. 6241--><p class="noindent" ><span 
class="cmtt-10">metal.T </span>is the temperature at the present timestep, which is used to accept or reject a perturbation
probabilistically by equation <a 
href="QubistHTMLse5.html#x15-24009r3">2.3<!--tex4ht:ref: eq:SA --></a>.
<a 
 id="dx108-165043"></a>
<a 
 id="dx108-165044"></a>
<!--l. 6245--><p class="noindent" ><span 
class="cmtt-10">metal.metric </span>contains distance information that is used internally by Anvil&#8217;s niching operator. Niching was
discussed in Section <a 
href="QubistHTMLse52.html#x78-1100008.9">8.9<!--tex4ht:ref: sec:par_niching --></a> in the context of the Ferret genetic algorithm, and is unusual in a simulated annealing code.
However, Anvil is part genetic algorithm, and its biological half uses a niching operator to maintain the diversity of
the &#8216;population&#8217; of simulated annealing tracks.
<!--l. 6247--><p class="noindent" >Unlike Ferret and Locust, (but like SAMOSA), Anvil carries a working set of optimal solutions around with it as it
runs, and therefore does not require an analysis step at the end of the run (see Section <a 
href="QubistHTMLse25.html#x42-630004.15">4.15<!--tex4ht:ref: sec:analysis --></a>). This greatly simplifies
the code, because it does not save History files (see Section <a 
href="QubistHTMLse26.html#x43-680004.16.4">4.16.4<!--tex4ht:ref: sec:History_files --></a>) as it runs, which makes Anvil
more useful as a polisher. Optimals are accumulated in <span 
class="cmtt-10">metal.OptimalSolutions </span>and are always
current, meaning that solutions that are no longer optimal are removed automatically at each time
step.
<!--l. 6249--><p class="noindent" >The <span 
class="cmtt-10">metal.OptimalSolutions </span>structure contains the internal fields discussed in Section <a 
href="QubistHTMLse80.html#x110-16900010.7">10.7<!--tex4ht:ref: sec:OptimalSolutions_Anvil --></a>, which have the same
meaning as their counterparts in the <span 
class="cmmi-10">metal </span>structure. Note that because Anvil does not save History files, Anvil
runs can&#8217;t be restarted after a crash the way that Ferret runs can. Anvil is really meant for smaller problems or
relatively quick polishing runs, so the extra complexity required for robust crash recovery is probably not
warranted.
<!--l. 6252--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">10.5.2   </span> <a 
 id="x108-16600010.5.2"></a>Built-In Stopping Criteria</h4>
<a 
 id="dx108-166001"></a>
<!--l. 6256--><p class="noindent" >Anvil has several built-in criteria that can be used to stop the code. These are as follows:
     <ul class="itemize1">
     <li class="itemize">
     The
     maximum
     number
     of
     time
     steps
     allowed
     by
     the
     user:
     <span 
class="cmtt-10">par.stopping.maxTimeSteps</span>.
                                                                                         

                                                                                         
     </li>
     <li class="itemize">
     The
     maximum
     allowed
     number
     of
     steps
     without
     improvement:
     <span 
class="cmtt-10">par.stopping.maxItNoImprovement</span>.
     </li>
     <li class="itemize">
     Tolerance
     in
     parameters:
     <span 
class="cmtt-10">par.stopping.XTol</span>.
     </li>
     <li class="itemize">
     Tolerance
     in
     fitness:
     <span 
class="cmtt-10">par.stopping.FTol</span></li></ul>
<!--l. 6263--><p class="noindent" >These stopping criteria are discussed in Section <a 
href="QubistHTMLse82.html#x112-17900010.9.8">10.9.8<!--tex4ht:ref: sec:par_stopping_Anvil --></a>, along with detailed advice on how to set up the built-in
stopping options.
<!--l. 6265--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">10.5.3   </span> <a 
 id="x108-16700010.5.3"></a>Custom Stopping Criterion</h4>
<a 
 id="dx108-167001"></a>
<a 
 id="dx108-167002"></a>
<a 
 id="dx108-167003"></a>
<!--l. 6271--><p class="noindent" >The most common use for the output function is to implement a custom stopping criterion. To stop Anvil from the
output function, with all necessary cleanup operations performed automatically, you just need to call the Qubist
function <span 
class="cmtt-10">abortQubist</span>, which automatically sets a global variable called <span 
class="cmmi-10">abortAnvil</span>_ = 1. Further
details of the <span 
class="cmtt-10">abortQubist </span>function are provided in Section <a 
href="QubistHTMLse19.html#x34-530004.9.2">4.9.2<!--tex4ht:ref: sec:customStopping --></a>. The following is a skeleton output
function that will stop Anvil when the user-defined function <span 
class="cmtt-10">checkStop(metal) </span>returns a value of
<span 
class="cmtt-10">true</span>:
<!--l. 6280--><p class="noindent" ><span 
class="colorbox" id="colorbox113"> <div class="minipage"><div class="BVerbatimInput"><span 
class="cmtt-10">function</span><span 
class="cmtt-10">&#x00A0;output(metal)</span><br /><br /><span 
class="cmtt-10">if</span><span 
class="cmtt-10">&#x00A0;checkStop(metal)</span><br />        <span 
class="cmtt-10">abortQubist;</span><br /><span 
class="cmtt-10">end</span></div>
</div></span>
                                                                                         

                                                                                         
<!--l. 6286--><p class="noindent" >Of course, it is possible to stop Anvil by directly setting the global variable <span 
class="cmtt-10">abortAnvil</span><span 
class="cmtt-10">_=1</span>. However, this is not
usually recommended because the other optimizers in the Qubist package won&#8217;t respond to <span 
class="cmmi-10">abortAnvil</span>_.
Unless this is the intended behaviour, you should stop Anvil by calling the <span 
class="cmtt-10">abortQubist </span>function
instead.
<a 
 id="dx108-167009"></a>
<a 
 id="dx108-167010"></a>
<a 
 id="dx108-167011"></a>
<!--l. 6291--><p class="noindent" >Like SAMOSA, it is possible to call Anvil from <span 
class="cmti-10">inside </span>a Ferret fitness function if you need to do an internal
optimization of a sub-problem during the evaluation of your Ferret fitness function. In this case, a call to
<span 
class="cmtt-10">abortQubist </span>in the inner optimization problem will stop Anvil without affecting the outer Ferret run. On the other
hand, Ferret will respond to an <span 
class="cmtt-10">abortQubist </span>call in the outer problem, which will stop the entire run. Please
refer to the demo titled &#8216;Advanced/Ferret-SAMOSA-Anvil-Insanity&#8217; for an illustrative example of this
technique.
                                                                                         

                                                                                         
<!--l. 6293--><div class="crosslinks"><p class="noindent">[<a 
href="QubistHTMLse79.html" >next</a>] [<a 
href="QubistHTMLse77.html" >prev</a>] [<a 
href="QubistHTMLse77.html#tailQubistHTMLse77.html" >prev-tail</a>] [<a 
href="QubistHTMLse78.html" >front</a>] [<a 
href="QubistHTMLch10.html#QubistHTMLse78.html" >up</a>] </p></div>
<!--l. 6293--><p class="noindent" ><a 
 id="tailQubistHTMLse78.html"></a>  
</body></html> 
