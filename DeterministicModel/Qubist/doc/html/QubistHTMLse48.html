<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>par.parallel</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html,frames,3 --> 
<meta name="src" content="QubistHTML.tex"> 
<meta name="date" content="2012-02-01 01:22:00"> 
<link rel="stylesheet" type="text/css" href="QubistHTML.css"> 
</head><body 
>
<!--l. 4257--><div class="crosslinks"><p class="noindent">[<a 
href="QubistHTMLse49.html" >next</a>] [<a 
href="QubistHTMLse47.html" >prev</a>] [<a 
href="QubistHTMLse47.html#tailQubistHTMLse47.html" >prev-tail</a>] [<a 
href="#tailQubistHTMLse48.html">tail</a>] [<a 
href="QubistHTMLch8.html#QubistHTMLse48.html" >up</a>] </p></div>
<h3 class="sectionHead"><span class="titlemark">8.5   </span> <a 
 id="x73-1040008.5"></a>par.parallel</h3>
<a 
 id="dx73-104001"></a>
<!--l. 4261--><p class="noindent" >The control parameters in <span 
class="cmtt-10">par.parallel </span>specify options that control Ferret&#8217;s parallel computing system, which was
the topic of Chapter <a 
href="QubistHTMLch6.html#x56-800006">6<!--tex4ht:ref: ch:parallel --></a>). Parallel computing with Ferret is very easy, and most of the parameters in this section
are fairly self explanatory. Note that some can be overridden using the node manager, as discussed
below.
<!--l. 4275--><p class="noindent" ><span 
class="colorbox" id="colorbox71"> <div class="minipage"><div class="BVerbatimInput"><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;Parallel</span><span 
class="cmtt-10">&#x00A0;Computing</span><br /><span 
class="cmtt-10">par.parallel.NWorkers=0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;[integer</span><span 
class="cmtt-10">&#x00A0;&#x003E;=</span><span 
class="cmtt-10">&#x00A0;0]:</span><span 
class="cmtt-10">&#x00A0;Number</span><span 
class="cmtt-10">&#x00A0;of</span><span 
class="cmtt-10">&#x00A0;worker</span><span 
class="cmtt-10">&#x00A0;nodes</span><span 
class="cmtt-10">&#x00A0;to</span><span 
class="cmtt-10">&#x00A0;launch</span><span 
class="cmtt-10">&#x00A0;initially.</span><br /><span 
class="cmtt-10">par.parallel.minChunkSize=10;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;[integer]:</span><span 
class="cmtt-10">&#x00A0;Minimum</span><span 
class="cmtt-10">&#x00A0;number</span><span 
class="cmtt-10">&#x00A0;of</span><span 
class="cmtt-10">&#x00A0;evaluations</span><span 
class="cmtt-10">&#x00A0;in</span><span 
class="cmtt-10">&#x00A0;each</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmsy-10">&#x2198;</span><br />      <img 
src="QubistHTML31x.png" alt="                                                                                                  `&#x2192;"  class="hookrightarrow" ><span 
class="cmtt-10">&#x00A0;work</span><span 
class="cmtt-10">&#x00A0;chunk.</span><br /><span 
class="cmtt-10">par.parallel.timeout=15;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;[integer</span><span 
class="cmtt-10">&#x00A0;&#x003E;=</span><span 
class="cmtt-10">&#x00A0;0]:</span><span 
class="cmtt-10">&#x00A0;Maximum</span><span 
class="cmtt-10">&#x00A0;time</span><span 
class="cmtt-10">&#x00A0;in</span><span 
class="cmtt-10">&#x00A0;seconds</span><span 
class="cmtt-10">&#x00A0;before</span><span 
class="cmtt-10">&#x00A0;an</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmsy-10">&#x2198;</span><br />      <img 
src="QubistHTML32x.png" alt="                                                                                                                                                                                                        `&#x2192;"  class="hookrightarrow" ><span 
class="cmtt-10">&#x00A0;unresponsive</span><span 
class="cmtt-10">&#x00A0;node</span><span 
class="cmtt-10">&#x00A0;disconnects.</span><br /><span 
class="cmtt-10">par.parallel.latency=0;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;[real</span><span 
class="cmtt-10">&#x00A0;&#x003E;</span><span 
class="cmtt-10">&#x00A0;0]:</span><span 
class="cmtt-10">&#x00A0;Time</span><span 
class="cmtt-10">&#x00A0;to</span><span 
class="cmtt-10">&#x00A0;pause</span><span 
class="cmtt-10">&#x00A0;in</span><span 
class="cmtt-10">&#x00A0;seconds</span><span 
class="cmtt-10">&#x00A0;after</span><span 
class="cmtt-10">&#x00A0;writing</span><span 
class="cmtt-10">&#x00A0;to</span><span 
class="cmtt-10">&#x00A0;the</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmsy-10">&#x2198;</span><br />      <img 
src="QubistHTML33x.png" alt="                                                                                                                                                                                                                                                                                                                                       `&#x2192;"  class="hookrightarrow" ><span 
class="cmtt-10">&#x00A0;scratch</span><span 
class="cmtt-10">&#x00A0;directory.</span><br /><span 
class="cmtt-10">par.parallel.useJava=true;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;[logical]:</span><span 
class="cmtt-10">&#x00A0;Is</span><span 
class="cmtt-10">&#x00A0;Java</span><span 
class="cmtt-10">&#x00A0;required</span><span 
class="cmtt-10">&#x00A0;for</span><span 
class="cmtt-10">&#x00A0;worker</span><span 
class="cmtt-10">&#x00A0;nodes?</span><br /><span 
class="cmtt-10">par.parallel.writeLogFiles=true;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;[logical]:</span><span 
class="cmtt-10">&#x00A0;Are</span><span 
class="cmtt-10">&#x00A0;log</span><span 
class="cmtt-10">&#x00A0;files</span><span 
class="cmtt-10">&#x00A0;required?</span></div>
</div></span>
<!--l. 4281--><p class="noindent" ><span 
class="cmtt-10">par.parallel.NWorkers </span>is an integer that specifies the number of worker nodes to start automatically when your
project starts. Recall that the main MATLAB process running Ferret does not count as a worker node, so that
<span 
class="cmmi-10">NWorkers </span>= 3 corresponds to four MATLAB processes working together on your project. Note that it is not
usually necessary to set <span 
class="cmtt-10">par.parallel.NWorkers </span>in your setup file, unless you <span 
class="cmti-10">always </span>want your project to start
with the same number of nodes, or you are using a custom launcher for a parallel run that does not start the
Ferret console (see Section <a 
href="QubistHTMLse24.html#x41-610004.14.2">4.14.2<!--tex4ht:ref: sec:customLauncher --></a>). Nodes can be started using the node manager interface at any time
after initializing the project, as discussed in Chapter <a 
href="QubistHTMLch6.html#x56-800006">6<!--tex4ht:ref: ch:parallel --></a>, which is the preferred method for starting
nodes.
<!--l. 4283--><p class="noindent" ><span 
class="cmtt-10">par.parallel.minChunkSize </span>is the minimum size of an &#8216;evaluation chunk&#8217; (the number of parameter sets) that is
sent to each worker node for evaluation. Parameter sets are divided between nodes according to the
formula
<table 
class="equation"><tr><td><a 
 id="x73-104012r2"></a>
<center class="math-display" >
<img 
src="QubistHTML34x.png" alt="chunkSize = min(N X,max (par.parallel.minChunkSize, ceil(N X&#x2215;N N odes&#x2215;nodeDistributionFactor)));
" class="math-display" ></center></td><td class="equation-label">(8.2)</td></tr></table>
<!--l. 4286--><p class="nopar" >
where <span 
class="cmmi-10">NX </span>is the number of parameter sets requiring evaluation, <span 
class="cmmi-10">NNodes </span>is the number of active nodes including
the Ferret console (node-0), and <span 
class="cmmi-10">nodeDistributionFactor </span>is a small integer (usually 3-5) that is set inside Ferret.
                                                                                         

                                                                                         
The <span 
class="cmmi-10">minChunkSize </span>parameter should always be greater than 1, and preferably at least 10. Low values result in
small evaluation chunks, which increase the communication overhead and decrease the efficiency of the
code.
<!--l. 4289--><p class="noindent" ><span 
class="cmtt-10">par.parallel.timeout </span>is the time to wait in seconds for an unresponsive node before disconnecting it and sending
a signal to try to shut down the node. In effect, this is the longest duration that Ferret could hang in the unlikely
event that a node crashes or becomes unresponsive while holding the lock for the scratch directory used by the
parallel computing system. As discussed in Chapter <a 
href="QubistHTMLch6.html#x56-800006">6<!--tex4ht:ref: ch:parallel --></a>, I recommend setting the timeout parameter to at least fifteen
seconds to avoid unnecessary node disconnections.
<!--l. 4291--><p class="noindent" ><span 
class="cmtt-10">par.parallel.latency </span>is the time to pause after a node writes results to the scratch file. This is sometimes useful
for networked disks on file systems when multiple computers are contributing to a parallel run, as discussed in
Chapter <a 
href="QubistHTMLch6.html#x56-800006">6<!--tex4ht:ref: ch:parallel --></a>. The <span 
class="cmmi-10">latency </span>parameter should be set to <span 
class="cmtt-10">par.parallel.latency=0 </span>if all of your nodes are running on the
same machine. Usually, I set this parameter to 0, unless I start seeing a lot of errors like &#8217;Unknown error calculating
fitness function. Re-evaluating <span 
class="cmmi-10">N </span>solutions.&#8217;. Such errors are actually harmless, but degrade the efficiency of the
code. See Section <a 
href="QubistHTMLse39.html#x61-890006.3">6.3<!--tex4ht:ref: sec:multimachine --></a> for details.
<!--l. 4293--><p class="noindent" ><span 
class="cmtt-10">par.parallel.useJava </span>is a logical parameter that determines whether Java will be used for nodes that are
started automatically when <span 
class="cmtt-10">par.parallel.minChunkSize &#x003E; 0</span>. Note that a &#8216;useJava&#8217; option is also
available in the node manager, which is the normal method for choosing whether or not to use Java.
However, once a node has been started, Java cannot be turned on or off without shutting it down and
re-starting.
<!--l. 4295--><p class="noindent" ><span 
class="cmtt-10">par.parallel.writeLogFiles </span>is a logical parameter that determines whether or not log files will be written to disk
showing the progress of each node. The log files will be written in the scratch subdirectory within the run&#8217;s data
directory, and will be named &#8216;log.<span 
class="cmmi-10">n</span>&#8217;, where <span 
class="cmmi-10">n </span>is the number of the associated worker node. The main Ferret console
writes logs to the file &#8216;log.0&#8217;. These are simple ascii text files that you can read with the MATLAB editor, or with
any text editor.
<a 
 id="dx73-104013"></a>
                                                                                         

                                                                                         
<!--l. 4301--><div class="crosslinks"><p class="noindent">[<a 
href="QubistHTMLse49.html" >next</a>] [<a 
href="QubistHTMLse47.html" >prev</a>] [<a 
href="QubistHTMLse47.html#tailQubistHTMLse47.html" >prev-tail</a>] [<a 
href="QubistHTMLse48.html" >front</a>] [<a 
href="QubistHTMLch8.html#QubistHTMLse48.html" >up</a>] </p></div>
<!--l. 4301--><p class="noindent" ><a 
 id="tailQubistHTMLse48.html"></a>  
</body></html> 
