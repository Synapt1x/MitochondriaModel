<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Running Anvil From the Command Line</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html,frames,3 --> 
<meta name="src" content="QubistHTML.tex"> 
<meta name="date" content="2012-02-01 01:22:00"> 
<link rel="stylesheet" type="text/css" href="QubistHTML.css"> 
</head><body 
>
<!--l. 6367--><div class="crosslinks"><p class="noindent">[<a 
href="QubistHTMLse82.html" >next</a>] [<a 
href="QubistHTMLse80.html" >prev</a>] [<a 
href="QubistHTMLse80.html#tailQubistHTMLse80.html" >prev-tail</a>] [<a 
href="#tailQubistHTMLse81.html">tail</a>] [<a 
href="QubistHTMLch10.html#QubistHTMLse81.html" >up</a>] </p></div>
<h3 class="sectionHead"><span class="titlemark">10.8   </span> <a 
 id="x111-17000010.8"></a>Running Anvil From the Command Line</h3>
<a 
 id="dx111-170001"></a>
<a 
 id="dx111-170002"></a>
<!--l. 6372--><p class="noindent" >The following script is an example of how you might start Anvil programmatically, perhaps from inside
one of your own functions or scripts. This plays the same role for Anvil as the custom launcher for
Ferret that was discussed in Section <a 
href="QubistHTMLse24.html#x41-610004.14.2">4.14.2<!--tex4ht:ref: sec:customLauncher --></a>, or the custom launcher for SAMOSA that was presented in
Section <a 
href="QubistHTMLse72.html#x101-1480009.9">9.9<!--tex4ht:ref: sec:commandLine_SAMOSA --></a>. Here, we make slightly tricker assumptions than we made for SAMOSA and assume the
following:
     <ul class="itemize1">
     <li class="itemize">
     QH
     is
     a
     string
     containing
     the
     global
     path
     to
     your
     Qubist
     home
     directory.
     On
     my
     Windows
     computer,
     this
     is
     &#8216;C:<span 
class="cmsy-10">\</span>Users<span 
class="cmsy-10">\</span>JFiege<span 
class="cmsy-10">\</span>Documents<span 
class="cmsy-10">\</span>Qubist&#8217;.
     </li>
     <li class="itemize">
     <a 
 id="dx111-170003"></a>
     The
     project
                                                                                         

                                                                                         
     is
     one
     of
     the
     Qubist
     demos,
     called
     &#8216;Data-Modeling/Data-Modeler-Small-PopSize&#8217;.
     This
     demo
     has
     all
     the
     bells
     and
     whistles
     of
     a
     more
     complicated
     project.
     </li>
     <li class="itemize">
     This
     is
     really
     a
     Ferret
     project,
     so
     nobody
     has
     bothered
     to
     make
     an
     AnvilSetup
     file.
     We
     need
     to
     convert
     FerretSetup,
     and
     would
     like
                                                                                         

                                                                                         
     to
     do
     this
     automatically.
     </li>
     <li class="itemize">
     <a 
 id="dx111-170004"></a>
     <a 
 id="dx111-170005"></a>The
     fitness
     function
     has
     the
     added
     complication
     that
     it
     contains
     a
     call
     to
     &#8216;isAbortEval&#8217;,
     which
     helps
     with
     parallel
     processing
     in
     Ferret
     and
     Locust.
     This
     function
     must
     be
     added
     to
     the
     path
     to
     avoid
     an
     error,
     even
     though
     Anvil
     doesn&#8217;t
                                                                                         

                                                                                         
     do
     parallel
     processing.
     </li>
     <li class="itemize">
     We
     don&#8217;t
     want
     to
     run
     with
     graphics.
     </li>
     <li class="itemize">
     We
     don&#8217;t
     want
     to
     mess
     around
     loading
     files
     at
     the
     end
     of
     the
     run.
     We
     want
     the
     <span 
class="cmmi-10">metal</span>
     and
     <span 
class="cmmi-10">OptimalSolutions</span>
     structures
     as
     output
     parameters.</li></ul>
<!--l. 6381--><p class="noindent" >The following custom launcher satisfies these requirements. The code for this example can be found in the file
[Qubist_Home]/user/Anvil/scripts/customLauncher.m.
<a 
 id="dx111-170006"></a>
<a 
 id="dx111-170007"></a>
<a 
 id="dx111-170008"></a>
<a 
 id="dx111-170009"></a>
                                                                                         

                                                                                         
<!--l. 6438--><p class="noindent" ><span 
class="colorbox" id="colorbox116"> <div class="minipage"><div class="BVerbatimInput"><span 
class="cmtt-10">function</span><span 
class="cmtt-10">&#x00A0;[metal,</span><span 
class="cmtt-10">&#x00A0;OptimalSolutions]=customLauncher</span><br /><br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;Set</span><span 
class="cmtt-10">&#x00A0;the</span><span 
class="cmtt-10">&#x00A0;Qubist</span><span 
class="cmtt-10">&#x00A0;component.</span><br /><span 
class="cmtt-10">global</span><span 
class="cmtt-10">&#x00A0;currentComponent_</span><br /><span 
class="cmtt-10">currentComponent_=&#8217;Anvil&#8217;;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;Set</span><span 
class="cmtt-10">&#x00A0;the</span><span 
class="cmtt-10">&#x00A0;component.</span><br /><span 
class="cmtt-10">%</span><br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;Reset</span><span 
class="cmtt-10">&#x00A0;the</span><span 
class="cmtt-10">&#x00A0;path:</span><br /><span 
class="cmtt-10">path(pathdef);</span><br /><span 
class="cmtt-10">%</span><br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;Set</span><span 
class="cmtt-10">&#x00A0;QH=Qubist</span><span 
class="cmtt-10">&#x00A0;Home</span><span 
class="cmtt-10">&#x00A0;directory.</span><br /><span 
class="cmtt-10">QH=&#8217;/Users/fiege/Documents/Qubist_Builder_PL/Qubist&#8217;;</span><br /><span 
class="cmtt-10">%</span><br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;Add</span><span 
class="cmtt-10">&#x00A0;Qubist</span><span 
class="cmtt-10">&#x00A0;paths:</span><br /><span 
class="cmtt-10">addpath(QH);</span><br /><span 
class="cmtt-10">setQubistPath(QH);</span><br /><span 
class="cmtt-10">%</span><br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;Add</span><span 
class="cmtt-10">&#x00A0;the</span><span 
class="cmtt-10">&#x00A0;project</span><span 
class="cmtt-10">&#x00A0;directory.</span><br /><span 
class="cmtt-10">addpath(genpath(fullfile(QH,</span><span 
class="cmtt-10">&#x00A0;&#8217;demos&#8217;,</span><span 
class="cmtt-10">&#x00A0;&#8217;Data-Modeling&#8217;,</span><span 
class="cmtt-10">&#x00A0;&#8217;Data-Modeler&#8217;)));</span><br /><span 
class="cmtt-10">%</span><br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;Force</span><span 
class="cmtt-10">&#x00A0;Qubist</span><span 
class="cmtt-10">&#x00A0;abort</span><span 
class="cmtt-10">&#x00A0;status</span><span 
class="cmtt-10">&#x00A0;to</span><span 
class="cmtt-10">&#x00A0;0</span><span 
class="cmtt-10">&#x00A0;so</span><span 
class="cmtt-10">&#x00A0;that</span><span 
class="cmtt-10">&#x00A0;Anvil</span><span 
class="cmtt-10">&#x00A0;can</span><span 
class="cmtt-10">&#x00A0;run.</span><br /><span 
class="cmtt-10">forceAbortQubist(0);</span><br /><span 
class="cmtt-10">%</span><br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;Get</span><span 
class="cmtt-10">&#x00A0;default</span><span 
class="cmtt-10">&#x00A0;Ferret</span><span 
class="cmtt-10">&#x00A0;setup</span><span 
class="cmtt-10">&#x00A0;and</span><span 
class="cmtt-10">&#x00A0;modify</span><span 
class="cmtt-10">&#x00A0;it</span><span 
class="cmtt-10">&#x00A0;using</span><span 
class="cmtt-10">&#x00A0;the</span><span 
class="cmtt-10">&#x00A0;project&#8217;s</span><span 
class="cmtt-10">&#x00A0;setup</span><span 
class="cmtt-10">&#x00A0;file.</span><br /><span 
class="cmtt-10">par=defaultFerretSetup;</span><br /><span 
class="cmtt-10">par=FerretSetup(par);</span><br /><span 
class="cmtt-10">%</span><br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;Translate</span><span 
class="cmtt-10">&#x00A0;it</span><span 
class="cmtt-10">&#x00A0;to</span><span 
class="cmtt-10">&#x00A0;an</span><span 
class="cmtt-10">&#x00A0;Anvil</span><span 
class="cmtt-10">&#x00A0;setup</span><span 
class="cmtt-10">&#x00A0;file.</span><br /><span 
class="cmtt-10">par=translateFerretToAnvil(par,defaultAnvilSetup);</span><br /><span 
class="cmtt-10">%</span><br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;Turn</span><span 
class="cmtt-10">&#x00A0;off</span><span 
class="cmtt-10">&#x00A0;graphics.</span><br /><span 
class="cmtt-10">par.interface.graphics=-1;</span><br /><span 
class="cmtt-10">%</span><br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;Load</span><span 
class="cmtt-10">&#x00A0;the</span><span 
class="cmtt-10">&#x00A0;init</span><span 
class="cmtt-10">&#x00A0;file,</span><span 
class="cmtt-10">&#x00A0;and</span><span 
class="cmtt-10">&#x00A0;add</span><span 
class="cmtt-10">&#x00A0;it</span><span 
class="cmtt-10">&#x00A0;to</span><span 
class="cmtt-10">&#x00A0;par.</span><br /><span 
class="cmtt-10">par.user.extPar=init;</span><br /><span 
class="cmtt-10">%</span><br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;----------------------------------------------------------------------</span><br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;Validate</span><span 
class="cmtt-10">&#x00A0;the</span><span 
class="cmtt-10">&#x00A0;fitness</span><span 
class="cmtt-10">&#x00A0;function.</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;Comment</span><span 
class="cmtt-10">&#x00A0;out</span><span 
class="cmtt-10">&#x00A0;these</span><span 
class="cmtt-10">&#x00A0;lines</span><span 
class="cmtt-10">&#x00A0;if</span><span 
class="cmtt-10">&#x00A0;to</span><span 
class="cmtt-10">&#x00A0;are</span><span 
class="cmtt-10">&#x00A0;running</span><br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;your</span><span 
class="cmtt-10">&#x00A0;project</span><span 
class="cmtt-10">&#x00A0;many</span><span 
class="cmtt-10">&#x00A0;times</span><span 
class="cmtt-10">&#x00A0;and</span><span 
class="cmtt-10">&#x00A0;are</span><span 
class="cmtt-10">&#x00A0;*sure*</span><span 
class="cmtt-10">&#x00A0;that</span><span 
class="cmtt-10">&#x00A0;your</span><span 
class="cmtt-10">&#x00A0;fitness</span><span 
class="cmtt-10">&#x00A0;function</span><span 
class="cmtt-10">&#x00A0;works.</span><br /><span 
class="cmtt-10">validateFitnessFunction(&#8217;Anvil&#8217;,</span><span 
class="cmtt-10">&#x00A0;par);</span><br /><span 
class="cmtt-10">%</span><br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;Abort</span><span 
class="cmtt-10">&#x00A0;if</span><span 
class="cmtt-10">&#x00A0;validation</span><span 
class="cmtt-10">&#x00A0;fails.</span><br /><span 
class="cmtt-10">if</span><span 
class="cmtt-10">&#x00A0;getQubistAbortStatus;</span><span 
class="cmtt-10">&#x00A0;%</span><span 
class="cmtt-10">&#x00A0;Checks</span><span 
class="cmtt-10">&#x00A0;the</span><span 
class="cmtt-10">&#x00A0;abort</span><span 
class="cmtt-10">&#x00A0;status.</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;disp(&#8217;Stopping</span><span 
class="cmtt-10">&#x00A0;due</span><span 
class="cmtt-10">&#x00A0;to</span><span 
class="cmtt-10">&#x00A0;problems</span><span 
class="cmtt-10">&#x00A0;with</span><span 
class="cmtt-10">&#x00A0;the</span><span 
class="cmtt-10">&#x00A0;fitness</span><span 
class="cmtt-10">&#x00A0;function...&#8217;);</span><br /><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;return</span><br /><span 
class="cmtt-10">end</span><br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;----------------------------------------------------------------------</span><br /><span 
class="cmtt-10">%</span><br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;Start</span><span 
class="cmtt-10">&#x00A0;Anvil!</span><br /><span 
class="cmtt-10">[metal,</span><span 
class="cmtt-10">&#x00A0;OptimalSolutions]=Anvil(par);</span></div>
</div></span>
<a 
 id="dx111-170059"></a>
<a 
 id="dx111-170060"></a>
                                                                                         

                                                                                         
<!--l. 6448--><div class="crosslinks"><p class="noindent">[<a 
href="QubistHTMLse82.html" >next</a>] [<a 
href="QubistHTMLse80.html" >prev</a>] [<a 
href="QubistHTMLse80.html#tailQubistHTMLse80.html" >prev-tail</a>] [<a 
href="QubistHTMLse81.html" >front</a>] [<a 
href="QubistHTMLch10.html#QubistHTMLse81.html" >up</a>] </p></div>
<!--l. 6448--><p class="noindent" ><a 
 id="tailQubistHTMLse81.html"></a>  
</body></html> 
